# PFM - Authentication API

## Getting Started

### Debug the API

Open the solution and make sure you set PFM.Auth.Api as the start up project. 

There is currently no support for Swagger.

### Test the API

```
POST http://localhost:4000/users/authenticate
{
	"username": "test",
	"password": "test"
}
```

```
POST http://localhost:4000/users/register
{
	"username": "jm89@pfm.com",
	"firstname": "firstname",
	"lastname": "lastname",
	"password": "securepassword"
}
```

```
GET http://localhost:4000/users/GetUserInfo
Authorization 'Bearer <token>'
```

#### ApiKey endpoints

```
POST http://localhost:4000/apikeys/validate
{
	"AppId": "6e16247f-d0f1-48d9-8f92-11623ae57dc9",
    	"AppName": "Bank Account API",
	"ApiKey":"<autogenerated-when-registering>"
}
```

```
POST http://localhost:4000/apikeys/register
{
	"AppId": "6a38d6d7-47a3-4fee-9614-35c28e8fc601"
}
```

## Publish the pfm-authentication-api docker image

Prerequisites:
- have a repository where to store the docker image

### Step 1: Docker Build

```
docker build . -t jm89/pfm-authentication-api:api-latest
```

### Step 2: Docker Run

```
docker run -p 5000:5000 -e ASPNETCORE_URLS="http://+:5000" jm89/pfm-authentication-api:api-latest
```

And check that you can ping the API:

```
curl -kv http://localhost:5000
```

### Step 3: Docker Push

```
docker login --password "<password>" --username "jm89"
```

```
docker push jm89/pfm-authentication-api:api-latest 
```

## Functional Requirements

|Use Case| Name| Description|
|---|---|---|
|[U_01](https://github.com/JM89/personalfinancemanager/wiki/U_01---User-Registration)| User Registering|Register a new user so he can start to use the application|
|[U_02](https://github.com/JM89/personalfinancemanager/wiki/U_02---User-Authentication)| User Authentication|Be able to log in a user so he can start to use the application|
|A_01| API Registration | Be able to register and validate APIs  with protected API Keys |

